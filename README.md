# neural image compression

## Запуск

### Кодирование

Чтобы сжать изображение ./compression-lab-imgs/lena.png выполните команду:
```
python encode.py -i ./compression-lab-imgs/lena.png
```

Обязательный параметр encode.py:
* ```--image_path```, ```-i``` - путь к картинке, котрую необходимо сжать

Опциональные параметрыencode.py:
* ```-B``` - разрядность квантования. Чем выше, тем выше ожидаемое качество декодироиванного изображения, но выше и размер сжатого файла. После квантования вектор признаков имеет $2^B$ уровней.
* ```--encode_output_path```, ```-o``` - путь, по которому должна храниться сжатая картинка. По умолчанию это ```f"{img_path_no_ext}_B{B}.neural"```
* ```compressor_state_path```, ```-s``` - путь, по которому должно храниться состояние алгоритма сжатия без потерь. По умолчанию: ```f"{img_path_no_ext}_B{B}_state.json"```
* ```--model_name```, ```-m``` - название нейронной сети для сжатия с потерями. Все модели перечислены в файле [trained_models.py](trained_models.py). По умолчанию ```"default"```
* ```--looseless_compressor_name```, ```-l``` - название алгоритма сжатия без потерь. На данный момент поддерживанется только "huffman"

### Декодирование

Обучение производилось на подможестве классов датасета Imagenet (ссылка). Подможество классов перечислено в файле.

Результаты при B = 6:
![Здесь должно быть изображение с результатами при B = 6](./readme_imgs/B6_results.png)